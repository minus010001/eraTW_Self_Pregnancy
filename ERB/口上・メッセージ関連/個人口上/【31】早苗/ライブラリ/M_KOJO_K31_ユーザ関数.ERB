;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;東風谷早苗口上において用いる関数置き場;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;-----------------------------------------------------------------------
;2017/4/29　Ver 0.03.04　追加	EVENT_次の選択肢_K31()
;								CHAPTER_今何章？_K31()
;2017/4/26　Ver 0.03.03　細部の修正
;2017/4/10　Ver 0.03.02　加筆	CHARA_INFO_KOJO_K31
;2017/3/26　Ver 0.03.01　追加	CHARA_INFO_KOJO_K31
;								次のシナリオ条件_K31
;2017/1/20　Ver 0.03.00　バージョン管理開始
;-----------------------------------------------------------------------
;@EVENT_CHECK_K31(ARG)
;イベントNo.(ARG)を踏んでいるかとうか
;返り値
;1:踏んでいますよ
;0:踏んでいませんよ
;イベント一覧(体験版Ver0.03時点)
;第1章 はじめまして
;	No.1 粗茶ですが
;	No.2 初接触
;	No.3 守矢の風祝
;	No.4 信じても鰯は鰯
;	No.5 信者ではないけれど
;	No.6 やっぱり鰯
;第1章 出会って3秒即约会！？
;	No.10001 無難な约会
;	No.10002 初约会は強引に
;	No.10003 触らぬ現人神に祟り無
;	No.10004 约会のあとで
;	No.10005 约会的对象は風祝
;	No.10006 嘘から出す真
;第2章 守矢さんちの現人神
;	No.11 守矢ファミリーズ
;	No.12 あくまでも協力員
;	No.13 奇跡のありがたみ
;	No.14 お手伝いさん？
;	No.15 神としての早苗さん
;	No.16 人としての早苗さん
;第2章 信者獲得大作戦
;	No.21 風祝としての力
;	No.22 信じてと言われても…
;	No.23 儚き信仰のために
;	No.24 力であつめる信仰
;	No.25 信者獲得？
;	No.26 外から支える屋台骨
;第2章 くじで繋がる縁
;	No.10011 満更でもなかったり
;	No.10012 布教のススメ
;	No.10013 人のうわさも…
;	No.10014 幻想報道○キシャ
;	No.10015 えれめんたりぃ、まいでぃあさなえ
;	No.10016 真ん中中央９５点
;第2章 奇跡のおこしかた
;	No.10021 ガールズ＆內褲ー
;	No.10022 ｑ！！
;	No.10023 手練による犯行？
;	No.10024 騙されてますよ！！
;	No.10025 興味ありません(嘘)
;	No.10026 ほっと一息
;-----------------------------------------------------------------------
@EVENT_CHECK_K31(ARG)
#FUNCTION
#DIM 第1選択肢
#DIM 第2選択肢
#DIM 第3選択肢
#DIM 第1章
#DIM 第2章
#DIM 第3章
#DIM 第4章
#DIM 第5章
#DIM 第6章

第1章 = CFLAG:31:K31_CFLAG_第1章シナリオ
第2章 = CFLAG:31:K31_CFLAG_第2章シナリオ
第3章 = CFLAG:31:K31_CFLAG_第3章シナリオ
第4章 = CFLAG:31:K31_CFLAG_第4章シナリオ
第5章 = CFLAG:31:K31_CFLAG_第5章シナリオ
第6章 = CFLAG:31:K31_CFLAG_第6章シナリオ


	;第1章
	IF (ARG < 10 && ARG > 0) || (ARG < 10010 && ARG > 10000)
		;第1章	はじめまして					イベントNo.0
		IF ARG < 10
			SIF 第1章 != 0
				RETURNF 0
		;第1章	出会って3秒即约会！？			イベントNo.10000
		ELSE
			SIF 第1章 != 10000
				RETURNF 0
		ENDIF
		第1選択肢 = (CFLAG:31:3100 / 1) % 10
		第2選択肢 = (CFLAG:31:3100 / 10) % 10
		第3選択肢 = (CFLAG:31:3100 / 100) % 10
		SELECTCASE ARG-第1章
		CASE 1
			;該当部分が正しければ
			SIF 第1選択肢 == 1
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 2
			;該当部分が正しければ
			SIF 第1選択肢 == 2
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 3
			;該当部分が正しければ
			SIF 第2選択肢 == 1
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 4
			;該当部分が正しければ
			SIF 第2選択肢 == 2
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 5
			;該当部分が正しければ
			SIF 第3選択肢 == 1
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 6
			;該当部分が正しければ
			SIF 第3選択肢 == 2
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASEELSE
			RETURNF 0
		ENDSELECT
	
	;第2章
	ELSEIF (ARG < 30 && ARG > 10) || (ARG < 10030 && ARG > 10010)
		;第2章	守矢さんちの現人神				イベントNo.10
		IF ARG < 20
			SIF 第2章 != 10
				RETURNF 0
		;第2章	守矢さんちの現人神				イベントNo.20
		ELSEIF ARG < 30
			SIF 第2章 != 20
				RETURNF 0
		;第2章	くじで繋がる縁					イベントNo.10010
		ELSEIF ARG < 10020
			SIF 第2章 != 10010
				RETURNF 0
		;第2章	奇跡のおこしかた				イベントNo.10020
		ELSE
			SIF 第1章 != 10020
				RETURNF 0
		ENDIF
		第1選択肢 = (CFLAG:31:3100 / 1000) % 10
		第2選択肢 = (CFLAG:31:3100 / 10000) % 10
		第3選択肢 = (CFLAG:31:3100 / 100000) % 10
		SELECTCASE ARG-第2章
		CASE 1
			;該当部分が正しければ
			SIF 第1選択肢 == 1
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 2
			;該当部分が正しければ
			SIF 第1選択肢 == 2
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 3
			;該当部分が正しければ
			SIF 第2選択肢 == 1
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 4
			;該当部分が正しければ
			SIF 第2選択肢 == 2
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 5
			;該当部分が正しければ
			SIF 第3選択肢 == 1
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASE 6
			;該当部分が正しければ
			SIF 第3選択肢 == 2
				;1を返す
				RETURNF 1
			;それ以外は0
			RETURNF 0
		CASEELSE
			RETURNF 0
		ENDSELECT
	
	
	
	ENDIF
RETURNF 0
;-----------------------------------------------------------------------
;@EVENT_次の選択肢_K31()
;次の選択肢は第何選択肢なのか
;返り値
;4:第4選択肢
;3:第3選択肢
;2:第2選択肢
;1:第1選択肢
;0:エラー(第6章到達又は想定しないエラー)
;-----------------------------------------------------------------------
@EVENT_次の選択肢_K31()
#FUNCTION
#DIM 選択肢履歴
#DIM 現在的章
#DIM 第1章
#DIM 第2章
#DIM 第3章
#DIM 第4章
#DIM 第5章
#DIM 第6章


選択肢履歴 = CFLAG:31:K31_CFLAG_選択肢履歴

現在的章 = CHAPTER_今何章？_K31()
SELECTCASE 現在的章
CASE 6
	RETURNF 0
CASE 5
	SIF 選択肢履歴 / 100000000000000
		RETURNF 4
	SIF 選択肢履歴 / 10000000000000
		RETURNF 3
	SIF 選択肢履歴 / 1000000000000
		RETURNF 2
	SIF 選択肢履歴 / 100000000000
		RETURNF 1
CASE 4
	SIF 選択肢履歴 / 100000000000
		RETURNF 4
	SIF 選択肢履歴 / 10000000000
		RETURNF 3
	SIF 選択肢履歴 / 1000000000
		RETURNF 2
	SIF 選択肢履歴 / 100000000
		RETURNF 1
CASE 3
	SIF 選択肢履歴 / 100000000
		RETURNF 4
	SIF 選択肢履歴 / 10000000
		RETURNF 3
	SIF 選択肢履歴 / 1000000
		RETURNF 2
	SIF 選択肢履歴 / 100000
		RETURNF 1
CASE 2
	SIF 選択肢履歴 / 100000
		RETURNF 4
	SIF 選択肢履歴 / 10000
		RETURNF 3
	SIF 選択肢履歴 / 1000
		RETURNF 2
	SIF 選択肢履歴 / 100
		RETURNF 1
CASE 1
	SIF 選択肢履歴 / 100
		RETURNF 4
	SIF 選択肢履歴 / 10
		RETURNF 3
	SIF 選択肢履歴 / 1
		RETURNF 2
CASE 0
	RETURNF 1
CASEELSE
	PRINTL エラー(@EVENT_次の選択肢())
ENDSELECT
RETURNF 0

;-----------------------------------------------------------------------
;@CHAPTER_今何章？_K31()
;今何章かを返す式中関数
;返り値
;0:第0章(面識無)
;1:第1章
;2:第2章
;3:第3章
;4:第4章
;5:第5章
;6:第6章
;-----------------------------------------------------------------------
@CHAPTER_今何章？_K31()
#FUNCTION
#DIM 第1章
#DIM 第2章
#DIM 第3章
#DIM 第4章
#DIM 第5章
#DIM 第6章

第1章 = CFLAG:31:K31_CFLAG_第1章シナリオ
第2章 = CFLAG:31:K31_CFLAG_第2章シナリオ
第3章 = CFLAG:31:K31_CFLAG_第3章シナリオ
第4章 = CFLAG:31:K31_CFLAG_第4章シナリオ
第5章 = CFLAG:31:K31_CFLAG_第5章シナリオ
第6章 = CFLAG:31:K31_CFLAG_第6章シナリオ

LOCAL = 6
SIF 第1章 == -1
	LOCAL --
SIF 第2章 == -1
	LOCAL --
SIF 第3章 == -1
	LOCAL --
SIF 第4章 == -1
	LOCAL --
SIF 第5章 == -1
	LOCAL --
SIF 第6章 == -1
	LOCAL --

RETURNF LOCAL

;-----------------------------------------------------------------------
;@CHAPTER_CHECK_K31(ARG)
;特定の章(イベントNo.(ARG))を通過しているかとうか
;返り値
;1:通過していますよ
;0:通過していませんよ
;章一覧
;第1章
;通常ルート「第1章　はじめまして」				イベントNo.0
;レアルート「第1章　出会って3秒即约会！？」	イベントNo.10000

;第2章
;通常ルート「第2章　守矢さんちの現人神」		イベントNo.10
;通常ルート「第2章　信者獲得大作戦」			イベントNo.20
;レアルート「第2章　くじで繋がる縁」			イベントNo.10010
;レアルート「第2章　奇跡のおこしかた」			イベントNo.10020

;第3章
;通常ルート「第3章　信者と神のアヤシイ関係」	イベントNo.100
;通常ルート「第3章　3年B組サナエさん」			イベントNo.110
;通常ルート「第3章　妖怪浴室ターズ」			イベントNo.120
;レアルート「第3章　どっちの的を射抜いたの？」	イベントNo.10100
;レアルート「第3章　守矢神社の早苗さん」		イベントNo.10110
;-----------------------------------------------------------------------
@CHAPTER_CHECK_K31(ARG)
#FUNCTION
#DIM 第1章
#DIM 第2章
#DIM 第3章
#DIM 第4章
#DIM 第5章
#DIM 第6章

第1章 = CFLAG:31:3101
第2章 = CFLAG:31:3102
第3章 = CFLAG:31:3103
第4章 = CFLAG:31:3104
第5章 = CFLAG:31:3105
第6章 = CFLAG:31:3106

;処理的には若干無駄だけど記述が一番簡単なので
SIF ARG == 第1章
	RETURNF 1
SIF ARG == 第2章
	RETURNF 1
SIF ARG == 第3章
	RETURNF 1
SIF ARG == 第4章
	RETURNF 1
SIF ARG == 第5章
	RETURNF 1
SIF ARG == 第6章
	RETURNF 1
RETURNF 0

;-----------------------------------------------------------------------
;@CHAPTER_攻略中_K31(ARG)
;特定の章(イベントNo.(ARG))を攻略中かとうか
;攻略中：その章に入っている+次の章に入っていない
;返り値
;1:攻略中ですよ
;0:攻略中ではない
;章一覧
;第1章(CFLAG:31:3101)
;通常ルート「第1章　はじめまして」				イベントNo.0
;レアルート「第1章　出会って3秒即约会！？」	イベントNo.10000

;第2章(CFLAG:31:3102)
;通常ルート「第2章　守矢さんちの現人神」		イベントNo.10
;通常ルート「第2章　信者獲得大作戦」			イベントNo.20
;レアルート「第2章　くじで繋がる縁」			イベントNo.10010
;レアルート「第2章　奇跡のおこしかた」			イベントNo.10020
;-----------------------------------------------------------------------
@CHAPTER_攻略中_K31(ARG)
#FUNCTION
#DIM 第1章
#DIM 第2章
#DIM 第3章
#DIM 第4章
#DIM 第5章
#DIM 第6章

第1章 = CFLAG:31:3101
第2章 = CFLAG:31:3102
第3章 = CFLAG:31:3103
第4章 = CFLAG:31:3104
第5章 = CFLAG:31:3105
第6章 = CFLAG:31:3106

;処理的には若干無駄だけど記述が一番簡単なので
SIF ARG == 第1章 && 第2章 == -1
	RETURNF 1
SIF ARG == 第2章 && 第3章 == -1
	RETURNF 1
SIF ARG == 第3章 && 第4章 == -1
	RETURNF 1
SIF ARG == 第4章 && 第5章 == -1
	RETURNF 1
SIF ARG == 第5章 && 第6章 == -1
	RETURNF 1
SIF ARG == 第6章
	RETURNF 1
RETURNF 0

;-----------------------------------------------------------------------------------------------
;@CHARA_INFO_KOJO_K31()
;個人情報の「角色介绍」の文章を書き換える
;これが那个ば「CSTR」の20番以降(20～39)に文字列を書き込むだけで書き換わるはず
;これを使いたくない場合はコメントアウトのこと
;-----------------------------------------------------------------------------------------------
@CHARA_INFO_KOJO_K31()
;===============================================================================================
;記述例
;このコメントアウトを外すと「CSTR」の20番以降に文字列を書き込むだけで書き換わるようになる
;FOR LOCAL,20,40
;	SIF CSTR:31:(LOCAL) != ""
;		PRINTFORML %CSTR:31:(LOCAL)%
;NEXT
;RETURN 1
;…とまあ、こんな感じでCSTR20番以降を使えばいいはず
;===============================================================================================
;本口上は、書き換わる文章が多いのでCSTRへの保存をせずに直接書き込む
;現時点で下の2行が書き込まれている
;PRINTL □ 角色介绍 □---------------------------------------------------------------------
;PRINTL 

;-----------------------------------------------------------------------------------------------
;使用するフラグ
;CFLAG:31:3100 各選択肢で何を選択したか(10進数管理) 
;000 000 000 000 000 
;5章、4章、3章、2章、1章の順、未選択なら0、Aルート選択だと1、Bルート選択だと2
;現状6章がゴールなので選択肢の記録が必要なのは5章まで
;CFLAG:31:3101 本口上の1章のシナリオ(未到達時は-1)
;CFLAG:31:3102 本口上の2章のシナリオ(未到達時は-1)
;CFLAG:31:3103 本口上の3章のシナリオ(未到達時は-1)
;CFLAG:31:3104 本口上の4章のシナリオ(未到達時は-1)
;CFLAG:31:3105 本口上の5章のシナリオ(未到達時は-1)
;CFLAG:31:3106 本口上の6章のシナリオ(未到達時は-1)
;-----------------------------------------------------------------------------------------------
;
;表記の一例として以下のような文章になるはず
;
;
;□ 角色介绍 □---------------------------------------------------------------------
;
;「～祭祀風的人類～　●種族：人類　●能力：引発奇跡程度的能力」
;
;「第2章　くじで繋がる縁」
;里での勧誘が忙しすぎて手が回らなくなってきたので、最近暇そうな人类を探していると
;目の前に、推定無職の人类がいたのでこれ幸いとスカウトした
;しかし、噂好きの人妖(主に天狗)の目に止まらないはずはなく
;ようやく収まってきた噂が再燃する結果に…
;
;なんやかんやと仕事を手伝ってくれる你には、感謝している
;ただ、出会いが出会いだったので直接言葉に出すことはないだろう、……たぶん
;
;
;【現在的関係】
;
;　　你と早苗の現在的関係性は、『知人』です
;
;【下一个進む条件】
;
;　　好感度1000信賴度100で「会話」を行う
;
;-----------------------------------------------------------------------------------------------


;##################################################################################
;①「～祭祀風的人類～　●種族：人類　●能力：引発奇跡程度的能力」を布丁ト
;##################################################################################
CALL M_KOJO_COLOR_K31
PRINTFORML %CSVCSTR(31, 10)%
RESETCOLOR
PRINTL 

;##################################################################################
;②角色介绍文を書き込み
;##################################################################################
;早苗さんと面識前
IF !CFLAG:31:18
	PRINTFORML 妖怪之山の上にある守矢神社の風祝
	PRINTFORML 元は外の世界の住人で、八坂神奈子・洩矢諏訪子の二柱と共に引っ越してきた
	PRINTL
	PRINTFORML 性格是たって明るく、坦率な人类なのだが、どこかずれている
	PRINTFORML また、ときどき真面目で自信家な一面が顔を覗かせることもある
	PRINTFORML 新たな人类が外の世界からやってきたという噂を聞き、
	PRINTFORML 幻想入り仲間として、初めての後輩ができるかもしれないと張り切っている
	PRINTL
	PRINTFORML 最近、信者獲得のために人里の方で勧誘を始めたらしい
	;条件を記述する部分へ飛ぶ
	GOTO 次のシナリオ登場の条件
ENDIF

;第1章
IF CFLAG:31:3102 == -1
	;「第1章　はじめまして」
	IF CHAPTER_攻略中_K31(0)
		FONTSTYLE 1
		PRINTFORML 「第1章　はじめまして」
		FONTREGULAR
		PRINTFORML 人类が外の世界からやってきたという噂を聞いた早苗
		PRINTFORML 幻想入り仲間として、初めての後輩ができるかもしれないということでさっそく話しかけてみることに
		PRINTFORML 話してみると、特に何の能力もなさそうな普通の人类だったので、
		PRINTFORML ようやく、まともな人类の知り合いができると喜んだ結果、最後でスベる
		PRINTL
		PRINTFORML 近ごろは、%CALLNAME:MASTER%相手にどうやって先輩風を吹かそうかと考えている
		SIF EVENT_CHECK_K31(5) || EVENT_CHECK_K31(6)
			PRINTFORML 人里での勧誘は、ライバルが多くあまりうまくいっていないようだ…
		;条件を記述する部分へ飛ぶ
		GOTO 次のシナリオ登場の条件
	ENDIF
	;「第1章　出会って3秒即约会！？」
	IF CHAPTER_攻略中_K31(10000)
		;レアルートは色を変えてみる
		CALL M_KOJO_COLOR_K31
		FONTSTYLE 1
		PRINTFORML 「第1章　出会って3秒即约会！？」
		FONTREGULAR
		PRINTFORML 気づいたら、守矢神社のくじの景品になっていた哀れな風祝
		PRINTFORML 普通ならば、すぐに気づいてやめさせるところだが、
		PRINTFORML なんの「奇跡」か、気づいた時には、運命のくじは既に引かれてしまったあとだった
		PRINTL
		PRINTFORML 仕方なく约会をした早苗だったが、山の連中にその姿をバッチリと見られ、
		PRINTFORML 妖怪之山是ま、早苗の约会の話題で持ちきりとなっている
		RESETCOLOR
		;条件を記述する部分へ飛ぶ
		GOTO 次のシナリオ登場の条件
	ENDIF
ENDIF

;第2章
IF CFLAG:31:3103 == -1
	;「第2章　守矢さんちの現人神」
	IF CHAPTER_攻略中_K31(10)
		FONTSTYLE 1
		PRINTFORML 「第2章　守矢さんちの現人神」
		FONTREGULAR
		PRINTFORML 最近、実は変な人类であることがバレつつある風祝
		PRINTFORML 初めてできた後輩に話しかけていくうち、外の話題で意気投合する
		PRINTFORML ひょんなことから、%CALLNAME:MASTER%に仕事の大変さを知られ
		PRINTFORML 里での勧誘を手伝ってもらうことになった
		PRINTL
		PRINTFORML 仕事を手伝ってくれる%CALLNAME:MASTER%へは、本当に感謝しているが
		PRINTFORML 本当に手伝ってもらっていいのかと不安になっている
		;条件を記述する部分へ飛ぶ
		GOTO 次のシナリオ登場の条件
	ENDIF
	;「第2章　信者獲得大作戦」
	IF CHAPTER_攻略中_K31(20)
		FONTSTYLE 1
		PRINTFORML 「第2章　信者獲得大作戦」
		FONTREGULAR
		PRINTFORML 最近、実は変な人类であることがバレつつある風祝
		PRINTFORML 初めてできた後輩に話しかけていくうち、外の話題で意気投合する
		PRINTFORML ひょんなことから、%CALLNAME:MASTER%に仕事の大変さを知られ
		PRINTFORML 里での勧誘を手伝ってもらうことになった
		PRINTL
		PRINTFORML 仕事を手伝ってくれる%CALLNAME:MASTER%へは、本当に感謝しているが
		PRINTFORML 本人の目の前で、『可疑宗教の勧誘に手を染めてしまった』などと言うのはやめてほしいと思っている
		;条件を記述する部分へ飛ぶ
		GOTO 次のシナリオ登場の条件
	ENDIF
	;「第2章　くじで繋がる縁」
	IF CHAPTER_攻略中_K31(10010)
		;レアルートは色を変えてみる
		CALL M_KOJO_COLOR_K31
		FONTSTYLE 1
		PRINTFORML 「第2章　くじで繋がる縁」
		FONTREGULAR
		PRINTFORML 里での勧誘が忙しすぎて手が回らなくなってきたので、最近暇そうな人类を探していると
		PRINTFORML 目の前に、推定無職の人类がいたのでこれ幸いとスカウトした
		PRINTFORML しかし、噂好きの人妖(主に天狗)の目に止まらないはずはなく
		PRINTFORML ようやく収まってきた噂が再燃する結果に…
		PRINTL
		PRINTFORML なんやかんやと仕事を手伝ってくれる%CALLNAME:MASTER%には、感謝している
		PRINTFORML ただ、出会いが出会いだったので直接言葉に出すことはないだろう、……たぶん
		RESETCOLOR
		;条件を記述する部分へ飛ぶ
		GOTO 次のシナリオ登場の条件
	ENDIF
	;「第2章　奇跡のおこしかた」
	IF CHAPTER_攻略中_K31(10020)
		;レアルートは色を変えてみる
		CALL M_KOJO_COLOR_K31
		FONTSTYLE 1
		PRINTFORML 「第2章　奇跡のおこしかた」
		FONTREGULAR
		PRINTFORML 里での勧誘が忙しすぎて手が回らなくなってきたので、最近暇そうな人类を探していると
		PRINTFORML 目の前に、推定無職の人类がいたのでこれ幸いとスカウトした
		PRINTFORML 噂好きの人妖(主に天狗)の目に止まらないはずはないのだが
		PRINTFORML 『今は泳がせたほうがもっと面白くなる』と表向きは静かなままとなっている
		PRINTL
		PRINTFORML なんやかんやと仕事を手伝ってくれる%CALLNAME:MASTER%へは、感謝しているが
		PRINTFORML 勢いや何やらで強引に押し付けたような気がして、気がとがめている
		PRINTL
		PRINTFORML どうやら最近起きている事件に興味を持ったらしく、色んな所で聞き込みを行っているらしい…
		RESETCOLOR
		;条件を記述する部分へ飛ぶ
		GOTO 次のシナリオ登場の条件
	ENDIF
ENDIF

$次のシナリオ登場の条件

;##################################################################################
;③現在的早苗との関係性の表示
;##################################################################################
PRINTL 
PRINTL 
CALL M_KOJO_COLOR_K31
PRINTFORML 【現在的関係】
PRINTL 
CALL COLORMESSAGE(@"　　%CALLNAME:MASTER%と早苗の現在的関係性は、『",C_YELLOW,0,0)
FONTSTYLE 1
IF !CFLAG:31:18
	SETCOLOR C_L_GRAY
	PRINTFORM 面識無
ELSEIF CFLAG:31:3102 == -1
	SETCOLOR C_WHITE
	PRINTFORM 他人
ELSEIF CFLAG:31:3103 == -1
	SETCOLOR C_P_BLUE
	PRINTFORM 知人
ELSEIF CFLAG:31:3104 == -1
	SETCOLOR C_P_YELLOW
	PRINTFORM 友人
ELSEIF CFLAG:31:3105 == -1
	SETCOLOR C_GREEN
	PRINTFORM 思慕
ELSEIF CFLAG:31:3106 == -1
	SETCOLOR C_RED
	PRINTFORM 恋慕
ELSE
	SETCOLOR C_PINK
	PRINTFORM 恋人
ENDIF
FONTREGULAR
CALL COLORMESSAGE("』です",C_YELLOW,1,0)
RESETCOLOR
PRINTL 
;##################################################################################
;④次のシナリオに進む条件の表示
;##################################################################################
CALL M_KOJO_COLOR_K31
PRINTFORML 【下一个進む条件】
PRINTL 
PRINT 　　
SETCOLOR C_YELLOW
CALL 次のシナリオ条件_K31(CFLAG:31:3100,CFLAG:31:3101,CFLAG:31:3102,CFLAG:31:3103,CFLAG:31:3104,CFLAG:31:3105,CFLAG:31:3106)
RESETCOLOR
RETURN 1

@次のシナリオ条件_K31(選択肢,第1章,第2章,第3章,第4章,第5章,第6章)
#DIM 選択肢
#DIM 第1章
#DIM 第2章
#DIM 第3章
#DIM 第4章
#DIM 第5章
#DIM 第6章

;早苗さんと面識前
IF !CFLAG:31:18
	PRINTFORML 早苗さんと出会う
	PRINTL 
	RETURN
ENDIF

;第1章
IF 第2章 == -1
	;「第1章　はじめまして」
	IF 第1章 == 0
		IF !(選択肢 / 10)
			PRINTFORML 好感度100で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 100)
			PRINTFORML 早苗さんの仕事中に「会話」 + %CALLNAME:MASTER%が约会中でない
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 1000)
			PRINTFORML 好感度500信賴度50で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
	ENDIF
	;「第1章　出会って3秒即约会！？」
	IF 第1章 == 10000
		IF !(選択肢 / 10)
			PRINTFORML 「会話」を行う + %CALLNAME:MASTER%が约会中でない + その日最初に出会う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 100)
			PRINTFORML 好感度300で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 1000)
			PRINTFORML 好感度500信賴度50で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
	ENDIF
ENDIF

;第2章
IF 第3章 == -1
	;「第2章　守矢さんちの現人神」
	IF 第2章 == 10
		IF !(選択肢 / 1000)
			PRINTFORML 好感度500で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 10000)
			PRINTFORML 好感度700で「幫忙干活」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 100000)
			PRINTFORML 好感度900で「幫忙干活」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 1000000)
			;PRINTFORML 好感度1000信賴度100で「会話」を行う
			PRINTFORML To Be Continued...
			PRINTL 
			RETURN
		ENDIF
	ENDIF
	;「第2章　信者獲得大作戦」
	IF 第2章 == 20
		IF !(選択肢 / 1000)
			PRINTFORML 好感度500で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 10000)
			PRINTFORML 好感度700で「幫忙干活」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 100000)
			PRINTFORML 好感度900で「幫忙干活」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 1000000)
			;PRINTFORML 好感度1000信賴度100で「会話」を行う
			PRINTFORML To Be Continued...
			PRINTL 
			RETURN
		ENDIF
	ENDIF
	;「第2章　くじで繋がる縁」
	IF 第2章 == 10010
		IF !(選択肢 / 1000)
			PRINTFORML 好感度500で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 10000)
			PRINTFORML 好感度700で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 100000)
			PRINTFORML 好感度900で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 1000000)
			;PRINTFORML 好感度1000信賴度100で「会話」を行う
			PRINTFORML To Be Continued...
			PRINTL 
			RETURN
		ENDIF
	ENDIF
	;「第2章　奇跡のおこしかた」
	IF 第2章 == 10020
		IF !(選択肢 / 1000)
			PRINTFORML 好感度500で「会話」を行う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 10000)
			PRINTFORML 好感度700以上 + その日最初に出会う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 100000)
			PRINTFORML 好感度900以上 + その日最初に出会う
			PRINTL 
			RETURN
		ENDIF
		IF !(選択肢 / 1000000)
			;PRINTFORML 好感度1000信賴度100で「会話」を行う
			PRINTFORML To Be Continued...
			PRINTL 
			RETURN
		ENDIF
	ENDIF
ENDIF

@フラグ初期化_K31()
;----------------------------------------------------------------------------------------
;シナリオ進行フラグ
;将来的に3100番台を1000番台にお引っ越しする予定なので関数に分割
;----------------------------------------------------------------------------------------
;選択肢記録フラグ
CFLAG:31:3100 = 0
;章シナリオ記録フラグ
CFLAG:31:3101 = -1
CFLAG:31:3102 = -1
CFLAG:31:3103 = -1
CFLAG:31:3104 = -1
CFLAG:31:3105 = -1
CFLAG:31:3106 = -1

;ONCE関数の初期化
CSTR:31:1 = ""
;FIRSTTIME関数の初期化
CSTR:31:0 = ""
;----------------------
;道具所持フラグ
;----------------------
CFLAG:31:3110 = 0

RETURN

;----------------------------------------------------------------------
;@CHECK_自室にいるか？_K31(ARG)
;ARG:角色番号
;返り値　1　その角色は自室に居るよ,0　その角色は自室にいないよ
;----------------------------------------------------------------------
@CHECK_自室にいるか？_K31(ARG)
#FUNCTION
SIF CFLAG:ARG:現在位置 == CFLAG:ARG:初期位置
	RETURNF 1
RETURNF 0
