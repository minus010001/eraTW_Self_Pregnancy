;---------------------------------------------------
;减少SOURCE
;---------------------------------------------------
;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;不潔のソース処理
;CALL		USER
;ARG		角色NO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_不潔(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:不潔

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 1.50
	CASE 1 TO 3
		TIMES LOCAL , 1.30
	CASE 4 TO 6
		TIMES LOCAL , 1.00
	CASE 7 TO 9
		TIMES LOCAL , 0.75
	CASE 10 TO 12
		TIMES LOCAL , 0.50
	CASE 13 TO 15
		TIMES LOCAL , 0.25
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT

SIF FLAG:催眠強度 > 0
	LOCAL = LOCAL * (100 - FLAG:催眠強度) / 100
SIF TALENT:反発抑制
	TIMES LOCAL , 0.50

CUP:ARG:不快 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;鬱屈のソース処理
;CALL		USER
;ARG		角色NO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_鬱屈(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:鬱屈
;心情
LOCAL = LOCAL * (10 - 2 * TALENT:ARG:15) / 10
;陥落素質
IF TALENT:ARG:恋慕
	TIMES LOCAL , 0.25
ELSEIF TALENT:ARG:思慕
	TIMES LOCAL , 0.75
ENDIF

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 1.50
	CASE 1 TO 3
		TIMES LOCAL , 1.30
	CASE 4 TO 6
		TIMES LOCAL , 1.00
	CASE 7 TO 9
		TIMES LOCAL , 0.75
	CASE 10 TO 12
		TIMES LOCAL , 0.50
	CASE 13 TO 15
		TIMES LOCAL , 0.25
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT
;ABL:欲望をみる
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL , 2.00
	CASE 1 TO 3
		TIMES LOCAL , 1.50
	CASE 4 TO 6
		TIMES LOCAL , 1.00
	CASE 7 TO 9
		TIMES LOCAL , 0.75
	CASE 10 TO 12
		TIMES LOCAL , 0.50
	CASE 13 TO 15
		TIMES LOCAL , 0.25
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT

SIF FLAG:催眠強度 > 0
	LOCAL = LOCAL * (100 - FLAG:催眠強度) / 100
SIF TALENT:反発抑制
	TIMES LOCAL , 0.50

CUP:ARG:抑鬱 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;逸脱のソース処理
;CALL		USER
;ARG		角色NO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_逸脱(ARG)
VARSET LOCAL
;好奇心と保守的はここで処理
SIF TALENT:ARG:性的兴趣 > 0
	TIMES SOURCE:ARG:逸脱 , 0.80
SIF TALENT:ARG:性的兴趣 < 0
	TIMES SOURCE:ARG:逸脱 , 2.00

LOCAL = SOURCE:ARG:逸脱

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 1.50
	CASE 1 TO 3
		TIMES LOCAL , 1.30
	CASE 4 TO 6
		TIMES LOCAL , 1.00
	CASE 7 TO 9
		TIMES LOCAL , 0.75
	CASE 10 TO 12
		TIMES LOCAL , 0.50
	CASE 13 TO 15
		TIMES LOCAL , 0.25
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT

;ABL:受虐属性をみる
SELECTCASE ABL:ARG:受虐属性
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1 TO 3
		TIMES LOCAL , 0.90
	CASE 3 TO 5
		TIMES LOCAL , 0.75
	CASE 6,7
		TIMES LOCAL , 0.60
	CASE 8,9
		TIMES LOCAL , 0.50
	CASE 10 TO 12
		TIMES LOCAL , 0.30
	CASE 13 TO 15
		TIMES LOCAL , 0.20
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT

SIF FLAG:催眠強度 > 0
	LOCAL = LOCAL * (100 - FLAG:催眠強度) / 100
SIF TALENT:反発抑制
	TIMES LOCAL , 0.50

CUP:ARG:反感 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;反感のソース処理
;CALL		USER
;ARG		角色NO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_反感(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:反感
;心情
LOCAL = LOCAL * (10 - 3 * TALENT:ARG:15) / 10
;对方主導
SIF ARG != MASTER && CFLAG:ARG:诶嘿嘿 == 2
	TIMES LOCAL, 0.3
SIF TALENT:ARG:路人 == 1
	LOCAL /= 2
SIF CFLAG:ARG:体目当て && TFLAG:理性削り
	LOCAL /= 2
;ABL:従順をみる
LOCAL:1 = ABL:ARG:従順 + ABL:ARG:親密
SELECTCASE LOCAL:1
	CASE 0
		TIMES LOCAL , 2.00
	CASE 1 TO 3
		TIMES LOCAL , 1.25
	CASE 4 TO 7
		TIMES LOCAL , 1.00
	CASE 8 TO 10
		TIMES LOCAL , 0.75
	CASE 11 TO 14
		TIMES LOCAL , 0.50
	CASE 15 TO 19
		TIMES LOCAL , 0.25
	CASE 20 TO 24
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.05
ENDSELECT

;ABL:奉仕精神をみる
SELECTCASE ABL:ARG:奉仕精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1 TO 3
		TIMES LOCAL , 0.90
	CASE 3 TO 5
		TIMES LOCAL , 0.75
	CASE 6,7
		TIMES LOCAL , 0.60
	CASE 8,9
		TIMES LOCAL , 0.50
	CASE 10 TO 12
		TIMES LOCAL , 0.30
	CASE 13 TO 15
		TIMES LOCAL , 0.20
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT

;ABL:受虐属性をみる
SELECTCASE ABL:ARG:受虐属性
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1 TO 3
		TIMES LOCAL , 0.90
	CASE 3 TO 5
		TIMES LOCAL , 0.75
	CASE 6,7
		TIMES LOCAL , 0.60
	CASE 8,9
		TIMES LOCAL , 0.50
	CASE 10 TO 12
		TIMES LOCAL , 0.30
	CASE 13 TO 15
		TIMES LOCAL , 0.20
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT

SIF FLAG:催眠強度 > 0
	LOCAL = LOCAL * (100 - FLAG:催眠強度) / 100
SIF TALENT:反発抑制
	TIMES LOCAL , 0.50

CUP:ARG:反感 += LOCAL