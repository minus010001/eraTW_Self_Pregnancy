;Ｃ感覚
@ABLUP0
CALL ABL_UP(0)

;Ｖ感覚
@ABLUP1
CALL ABL_UP(1)

;Ａ感覚
@ABLUP2
CALL ABL_UP(2)

;B感覚
@ABLUP3
CALL ABL_UP(3)
;Ｍ感覚
@ABLUP4
CALL ABL_UP(4)

;従順
@ABLUP10
CALL ABL_UP(10)

;欲望
@ABLUP11
CALL ABL_UP(11)

;技巧
@ABLUP12
CALL ABL_UP(12)

;奉仕精神
@ABLUP13
CALL ABL_UP(13)

;露出癖
@ABLUP14
CALL ABL_UP(14)

;受虐狂ッ気
@ABLUP15
CALL ABL_UP(15)

;施虐狂ッ気
@ABLUP16
CALL ABL_UP(16)

;レズッ気
@ABLUP17
CALL ABL_UP(17)

;ホモッ気
@ABLUP18
CALL ABL_UP(18)

;自慰中毒
@ABLUP30
CALL ABL_UP(30)

;精液中毒
@ABLUP31
CALL ABL_UP(31)

;百合中毒
@ABLUP32
CALL ABL_UP(32)

;断袖中毒
@ABLUP33
CALL ABL_UP(33)

@ABLUP34
CALL ABL_UP(34)
@ABLUP35
CALL ABL_UP(35)
;汎用処理
@ABL_UP(ARG)
[SKIPSTART]
DRAWLINE
;上限
CALL MAXABL(ARG)
SIF RESULT
	RETURN 0

VARSET LOCAL
;個別処理
;奉仕精神
SIF ARG == 13
	PRINTFORML 従順{ABL:ARG + 1}LV以上必要
;受虐狂ッ気
SIF ARG == 15
	PRINTFORML 欲望{ABL:ARG + 1}LV以上必要
;施虐狂ッ気
SIF ARG == 16
	PRINTFORML 欲望{ABL:ARG + 1}LV以上必要
;自慰中毒
SIF ARG == 30
	PRINTFORML Ｃ感覚{ABL:ARG + 1}LV以上、露出癖{ABL:ARG + 1}LV以上必要
;精液中毒
SIF ARG == 31
	PRINTFORML 奉仕精神{ABL:ARG + 1}LV以上必要
;百合中毒
SIF ARG == 32
	PRINTFORML 百合属性{ABL:ARG + 1}LV以上必要
;断袖中毒
SIF ARG == 33
	PRINTFORML 断袖属性{ABL:ARG + 1}LV以上必要

IF EXP_DEMAND(ARG,0,53) == 1
	PRINTFORML 并且有異常経験
ELSEIF EXP_DEMAND(ARG,0,53) > 1
	PRINTFORML 并且有異常経験{EXP_DEMAND(ARG,0,43)}以上
ENDIF
FOR LOCAL,0,4
	IF JUEL_DEMAND(ARG,LOCAL) == -2
		PRINTL 能力不足
		BREAK
	ENDIF
	SIF JUEL_DEMAND(ARG,LOCAL) < 0
		CONTINUE
	PRINTFORM [{LOCAL}] -
	;必要な宝珠を尋找
	FOR LOCAL:1,0,100
		IF JUEL_DEMAND(ARG,LOCAL,LOCAL:1) > 0
			SIF JUEL:(LOCAL:1) < JUEL_DEMAND(ARG,LOCAL,LOCAL:1)
				LOCAL:3 ++
			PRINTFORM  %PALAMNAME:(LOCAL:1)%之珠×{JUEL_DEMAND(ARG,LOCAL,LOCAL:1)}
		ENDIF
	NEXT
	;必要な経験を尋找
	FOR LOCAL:1,0,100
		IF EXP_DEMAND(ARG,LOCAL,LOCAL:1) > 0
			SIF  EXP:(LOCAL:1) < EXP_DEMAND(ARG,LOCAL,LOCAL:1)
				LOCAL:4 ++
			;異常経験は先に処理した
			SIF LOCAL:1 == 43
				CONTINUE
			PRINTFORM  %EXPNAME:(LOCAL:1)%
			IF EXP_DEMAND(ARG,LOCAL,LOCAL:1) == 1
				PRINT が必要
			ELSE
				PRINTFORM {EXP_DEMAND(ARG,LOCAL,LOCAL:1)}以上
			ENDIF
		ENDIF
	NEXT
	PRINT ・・・
	SIF LOCAL:3
		PRINT  宝珠不足
	SIF LOCAL:4
		PRINT  経験不足
	IF !LOCAL:3 && !LOCAL:4 && !LOCAL:5
		LOCAL:(10 + LOCAL) = 1
		PRINT ＯＫ
	ENDIF
	LOCAL:3 = 0
	LOCAL:4 = 0
	LOCAL:5 = 0
	PRINTL 
NEXT

PRINTL [100] - 放棄

INPUT
IF RESULT == 100
	RETURN 0
;ELSEIF RESULT < 0 || RESULT > LOCAL
;	RESTART
;ELSEIF !LOCAL:(10 + RESULT)
;	PRINTW 条件を満たしていません
;	RESTART
ELSE
	RETURN 0
ENDIF

FOR LOCAL,0,40
	JUEL:LOCAL -= JUEL_DEMAND(ARG,RESULT,LOCAL)
NEXT
ABL:ARG += 1
PRINTFORMW %ABLNAME:ARG%的等级变为了{ABL:ARG}

[SKIPEND]
RETURN 0

@ISABLUP(ARG)
#FUNCTION
VARSET LOCAL
;上限設定
IF ABL:ARG >= 99
	RETURNF 0
ELSEIF ABL:ARG >= 5 && !TALENT:3
	RETURNF 0
ENDIF

FOR LOCAL,0,4
	SIF JUEL_DEMAND(ARG,LOCAL) == -2
		RETURNF 0
	SIF JUEL_DEMAND(ARG,LOCAL) < 0
		CONTINUE
	;必要な宝珠を尋找
	FOR LOCAL:1,0,100
		IF JUEL_DEMAND(ARG,LOCAL,LOCAL:1) > 0
			SIF JUEL:(LOCAL:1) < JUEL_DEMAND(ARG,LOCAL,LOCAL:1)
				LOCAL:2 ++
		ENDIF
	NEXT
	;必要な経験を尋找
	FOR LOCAL:1,0,100
		IF EXP_DEMAND(ARG,LOCAL,LOCAL:1) > 0
			SIF  EXP:(LOCAL:1) < EXP_DEMAND(ARG,LOCAL,LOCAL:1)
				LOCAL:2 ++ 
		ENDIF
	NEXT
	SIF !LOCAL:2
		RETURNF 1
	LOCAL:2 = 0
NEXT

@JUEL_UP_SPECIAL(ARG,増やす珠,参照能力,PERCENTAGE,表示,PATTERN)
#DIMS 増やす珠
#DIMS 参照能力
#DIM UP_JL
#DIM UP_ABL
#DIM PERCENTAGE
#DIM 表示
#DIM PATTERN
#DIM 上昇量
;特殊なイベントで珠を増やすための関数
;ARGのJUEL:UP_JLの珠をABL:UP_ABLを上げるために必要なPERCENTAGEパーセントだけ増やすよ

;使用例:快Ｃ(0)を自慰中毒(30)上げるのに必要な量の50%だけ上げる、メッセージ表示する
;CALL JUEL_UP_SPECIAL(ARG,"快Ｃ","自慰中毒",50,1)

UP_ABL = FINDELEMENT(ABLNAME, 参照能力)
UP_JL = FINDELEMENT(PALAMNAME, 増やす珠)

SELECTCASE UP_ABL
	CASE 0
		LOCAL = JUEL_DEMAND_0(PATTERN,UP_JL,ARG)
		LOCAL = LOCAL * (2 + TALENT:ARG:Ｃ感度) / 2
	CASE 1
		LOCAL = JUEL_DEMAND_1(PATTERN,UP_JL,ARG)
		LOCAL = LOCAL * (2 + TALENT:ARG:Ｖ感度) / 2
	CASE 2
		LOCAL = JUEL_DEMAND_2(PATTERN,UP_JL,ARG)
		LOCAL = LOCAL * (2 + TALENT:ARG:Ａ感度) / 2
	CASE 3
		LOCAL = JUEL_DEMAND_3(PATTERN,UP_JL,ARG)
		LOCAL = LOCAL * (2 + TALENT:ARG:Ｂ感度) / 2
	CASE 4
		LOCAL = JUEL_DEMAND_4(PATTERN,UP_JL,ARG)
		LOCAL = LOCAL * (2 + TALENT:ARG:Ｍ感度) / 2
	CASE 10
		LOCAL = JUEL_DEMAND_10(PATTERN,UP_JL,ARG)
	CASE 11
		LOCAL = JUEL_DEMAND_11(PATTERN,UP_JL,ARG)
	CASE 12
		LOCAL = JUEL_DEMAND_12(PATTERN,UP_JL,ARG)
	CASE 13
		LOCAL = JUEL_DEMAND_13(PATTERN,UP_JL,ARG)
	CASE 14
		LOCAL = JUEL_DEMAND_14(PATTERN,UP_JL,ARG)
	CASE 15
		LOCAL = JUEL_DEMAND_15(PATTERN,UP_JL,ARG)
	CASE 16
		LOCAL = JUEL_DEMAND_16(PATTERN,UP_JL,ARG)
	CASE 17
		LOCAL = JUEL_DEMAND_17(PATTERN,UP_JL,ARG)
	CASE 18
		LOCAL = JUEL_DEMAND_18(PATTERN,UP_JL,ARG)
	CASE 30
		LOCAL = JUEL_DEMAND_30(PATTERN,UP_JL,ARG)
	CASE 31
		LOCAL = JUEL_DEMAND_31(PATTERN,UP_JL,ARG)
	CASE 32
		LOCAL = JUEL_DEMAND_32(PATTERN,UP_JL,ARG)
	CASE 33
		LOCAL = JUEL_DEMAND_33(PATTERN,UP_JL,ARG)
	CASE 34
		LOCAL = JUEL_DEMAND_34(PATTERN,UP_JL,ARG)
	CASE 35
		LOCAL = JUEL_DEMAND_35(PATTERN,UP_JL,ARG)
ENDSELECT
上昇量 = MAX(LOCAL * PERCENTAGE / 100, PERCENTAGE)
JUEL:ARG:UP_JL += 上昇量
;PRINTFORML %PALAMNAME:UP_JL%の珠 ＋{LOCAL * PERCENTAGE / 100} （%CALLNAME:ARG%）
IF 表示
	CALL COLORMESSAGE(@"%PALAMNAME:UP_JL%の珠 ＋{上昇量} （%CALLNAME:ARG%）",C_PINK,1)
ELSE
	[IF_DEBUG]
	CALL COLORMESSAGE(@"%PALAMNAME:UP_JL%の珠 ＋{上昇量} （%CALLNAME:ARG%）",C_PINK,1)
	[ENDIF]
ENDIF